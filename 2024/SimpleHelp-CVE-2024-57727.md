# SimpleHelp Remote Support Software Path Traversal & Related Vulnerabilities  
**(CVE-2024-57727, CVE-2024-57726, CVE-2024-57728)**  

**Author:** Brian Maroney  
**Date:** 2025-10-27  
**Status:** experimental  
**Severity:** Critical  

---

## Purpose
Detect attempts to exploit **CVE-2024-57727**, an unauthenticated path traversal vulnerability in SimpleHelp Remote Support Software (≤ 5.5.7) that allows arbitrary file download from the server host.  
Also references two related vulnerabilities:  
- **CVE-2024-57726** – Technician-to-Admin privilege escalation  
- **CVE-2024-57728** – Authenticated arbitrary file upload → remote code execution  

These issues are known to be **exploited in ransomware campaigns** and are on the **CISA Known Exploited Vulnerabilities (KEV)** list.  

---

## Metadata (YAML)
```yaml
title: SimpleHelp Remote Support Software Path Traversal (CVE-2024-57727)
id: 8cfb2a2f-c1e5-49e3-8a13-cve202457727
status: experimental
description: >
  Detects unauthenticated HTTP requests exploiting the SimpleHelp Remote Support
  Software path traversal vulnerability (CVE-2024-57727) that allows arbitrary
  file download from the host, exposing configuration secrets and credentials.
author: Brian Maroney
date: 2025-10-27
tags:
  - cve.2024-57727
  - attack.t1005
  - attack.t1083
  - attack.initial_access
  - product.simplehelp
logsource:
  category: webserver
  product: simplehelp
level: critical
```

---

## Logic
```yaml
detection:
  ldapnightmare_lsass_crash:
    # LSASS application error events that point to WLDAP32.dll as the faulting module
    EventID: 1000
    faulting.application|contains: "lsass.exe"
    faulting.module|contains: "WLDAP32.dll"

  ldapnightmare_fake_tools:
    # Known PoC / fake exploit artifacts observed in the wild (files, URLs, hashes)
    file.name|contains:
      - "poc.exe"
    url|contains:
      - "ftpupload.net/htdocs"
      - "pastebin.com/raw/9TxS7Ldc"
      - "ftp.drivehq.com/wwwhome"
    file.hash.md5:
      - "ef4ba8eef919251f7502c7e66926bb3a5422065b"
      - "d4a35487b95cc2b44395047717358bb2863a5311"

  correlation_enrichment:
    # Suggested additional signals to correlate for higher confidence
    - dce_rpc_activity
    - cldap_traffic
    - firewall_logs
    - dns_logs
    - patch_management_inventory

  exclusions:
    # Optional: add known update servers, admin scanning IPs, and maintenance windows
    src_ip|in: []

  condition: ldapnightmare_lsass_crash or ldapnightmare_fake_tools


```

---

## Splunk Query
```yaml
index=web OR index=proxy (sourcetype=simplehelp:web OR sourcetype=apache:access)
earliest=-1h
| where method IN ("GET","POST")
| where like(uri_path,"%../%") OR like(uri_query,"%../%")
| where match(uri_path,"(?i)(etc/passwd|serverconfig\\.xml|application\\.properties|id_rsa|\\.ssh|\\.key|\\.pem|\\.ini|\\.conf)")
| eval ua=coalesce(user_agent,"-"), status=coalesce(status,0)
| where status IN (200,206)
| stats count AS hits values(uri_path) AS paths values(user_agent) AS user_agents by src_ip, dest_ip
| where hits>=3
| where NOT cidrmatch("10.0.0.0/8", src_ip)
  AND NOT cidrmatch("192.168.0.0/16", src_ip)
  AND NOT cidrmatch("172.16.0.0/12", src_ip)
| sort - hits



