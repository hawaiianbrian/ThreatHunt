# SimpleHelp Remote Support Software Path Traversal & Related Vulnerabilities  
**(CVE-2024-57727, CVE-2024-57726, CVE-2024-57728)**  

**Author:** Brian Maroney  
**Date:** 2025-10-27  
**Status:** experimental  
**Severity:** Critical  

---

## Purpose
Detect attempts to exploit **CVE-2024-57727**, an unauthenticated path traversal vulnerability in SimpleHelp Remote Support Software (≤ 5.5.7) that allows arbitrary file download from the server host.  
Also references two related vulnerabilities:  
- **CVE-2024-57726** – Technician-to-Admin privilege escalation  
- **CVE-2024-57728** – Authenticated arbitrary file upload → remote code execution  

These issues are known to be **exploited in ransomware campaigns** and are on the **CISA Known Exploited Vulnerabilities (KEV)** list.  

---

## Metadata (YAML)
```yaml
title: SimpleHelp Remote Support Software Path Traversal (CVE-2024-57727)
id: 8cfb2a2f-c1e5-49e3-8a13-cve202457727
status: experimental
description: >
  Detects unauthenticated HTTP requests exploiting the SimpleHelp Remote Support
  Software path traversal vulnerability (CVE-2024-57727) that allows arbitrary
  file download from the host, exposing configuration secrets and credentials.
author: Brian Maroney
date: 2025-10-27
tags:
  - cve.2024-57727
  - attack.t1005
  - attack.t1083
  - attack.initial_access
  - product.simplehelp
logsource:
  category: webserver
  product: simplehelp
level: critical
```

---

## Logic
```yaml
detection:
  selection_path_traversal:
    http.request_method:
      - GET
      - POST
    http.url|contains:
      - "../"
      - "..\\"
    http.url|re: "(?i)(etc/passwd|serverconfig\\.xml|application\\.properties|id_rsa|\\.ssh|\\.key|\\.pem|\\.ini|\\.conf)"
    http.status_code:
      - 200
      - 206

  selection_simplehelp_signature:
    http.user_agent|contains:
      - "SimpleHelp"
    http.url|contains:
      - "/allversions"
      - "/downloads/"
      - "/help/"

  exclusions:
    src_ip|in:
      - "10.0.0.0/8"
      - "192.168.0.0/16"
      - "172.16.0.0/12"

  condition: selection_path_traversal and not exclusions

```

---

## Splunk Query
```yaml
index=Index (sourcetype=simplehelp:web) 
| where method IN ("GET","POST")
  AND (like(uri_path,"%../%") OR like(uri_query,"%../%") OR like(uri_path,"%25%32%65%25%32%65%")) 
  AND match(uri_path,"(?i)(etc/passwd|serverconfig\\.xml|application\\.properties|id_rsa|\\.ssh|\\.pem|\\.ini|\\.conf)")
  AND status IN (200,206)
| stats count AS hits values(uri_path) AS paths values(user_agent) AS user_agents earliest(_time) AS first_seen latest(_time) AS last_seen by src_ip, dest_ip
| where hits >= 3
| where NOT cidrmatch("10.0.0.0/8", src_ip) AND NOT cidrmatch("192.168.0.0/16", src_ip) AND NOT cidrmatch("172.16.0.0/12", src_ip)
| sort - hits


