# FortiWeb /api/fabric/device/status SQL Injection (CVE-2025-25257)  
**Fortinet FortiWeb Unauthenticated SQL Injection â†’ Remote Code Execution**

**Author:** Brian Maroney  
**Date:** 2025-07-18  
**Status:** experimental  
**Severity:** Critical  

---

## Purpose
Detect exploitation attempts targeting **CVE-2025-25257**, a critical unauthenticated SQL injection vulnerability in Fortinet FortiWeb appliances.  
Attackers exploit the `/api/fabric/device/status` endpoint via the **Authorization Bearer** header to perform arbitrary SQL statements (e.g., `SELECT ... INTO OUTFILE`), enabling **remote code execution** by writing Python `.pth` backdoor files to disk.  
Public PoC code and in-the-wild exploitation have been confirmed as of **July 18, 2025**.

---

## Metadata (YAML)
```yaml
title: "FortiWeb /api/fabric/device/status SQL Injection (CVE-2025-25257)"
id: "fweb-cve-2025-25257-sqli"
status: experimental
description: >
  Detects unauthenticated SQL injection exploitation attempts against
  Fortinet FortiWeb appliances via /api/fabric/device/status endpoint.
  Attackers leverage Authorization Bearer header to execute SQL commands
  using SELECT ... INTO OUTFILE for code execution and backdoor installation.
author: "Brian Maroney"
date: "2025-07-18"
tags:
  - cve.2025-25257
  - attack.t1190
  - attack.initial_access
  - attack.t1505
  - product.fortinet.fortiweb
  - exploit.sqlinjection
logsource:
  category: webserver
  product: fortiweb
level: critical

```
---

## Detection Logic (YAML)
```yaml
detection:
  sqli_exploit_pattern:
    # Unauthenticated SQLi exploitation through /api/fabric/device/status
    http.request_method:
      - POST
    http.url|contains:
      - "/api/fabric/device/status"
    http.header.Authorization|re: "(?i)Bearer.+(SELECT|INTO\\s+OUTFILE|')"
    http.body|re: "(?i)(SELECT|INTO\\s+OUTFILE|backdoor|pth)"
    http.status:
      - 200
      - 500

  suspicious_file_artifacts:
    # Creation of suspicious Python loader files on the appliance
    file.path|endswith:
      - ".pth"
    file.path|contains:
      - "site-packages"
    process.name|contains:
      - "python"

  exclusions:
    # Optional: exclude internal testing IP ranges or management scanners
    src_ip|in:
      - "10.0.0.0/8"
      - "192.168.0.0/16"
      - "172.16.0.0/12"

  condition: sqli_exploit_pattern or suspicious_file_artifacts and not exclusions
```
---

## Splunk Query
```yaml
index=fortiweb OR sourcetype=fortiweb:web
| where method="POST"
  AND like(uri_path,"%/api/fabric/device/status%")
  AND (
    match(http_auth_header,"(?i)Bearer.+(SELECT|INTO\\s+OUTFILE|backdoor|pth)")
    OR match(request_body,"(?i)(SELECT|OUTFILE|pth|backdoor)")
  )
| stats count earliest(_time) as first_seen latest(_time) as last_seen values(src_ip) as src_ip values(dest_ip) as dest_ip values(http_auth_header) as headers by uri_path
| where NOT cidrmatch("10.0.0.0/8", src_ip)
  AND NOT cidrmatch("192.168.0.0/16", src_ip)
  AND NOT cidrmatch("172.16.0.0/12", src_ip)
| sort - count
